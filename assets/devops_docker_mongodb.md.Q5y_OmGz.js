import{_ as s,o as i,c as a,R as e}from"./chunks/framework.0ARc0mp4.js";const F=JSON.parse('{"title":"Docker安装MongoDB服务","description":"Docker安装MongoDB服务","frontmatter":{"title":"Docker安装MongoDB服务","head":[["meta",{"name":"description","content":"Docker安装MongoDB服务"}],["meta",{"name":"keywords","content":"docker 容器 镜像 mongodb"}]]},"headers":[],"relativePath":"devops/docker/mongodb.md","filePath":"devops/docker/mongodb.md","lastUpdated":1716571481000}'),t={name:"devops/docker/mongodb.md"},d=e('<h2 id="下载mongodb镜像" tabindex="-1">下载MongoDB镜像 <a class="header-anchor" href="#下载mongodb镜像" aria-label="Permalink to &quot;下载MongoDB镜像&quot;">​</a></h2><p>这里以最新版本的MongoDB为例</p><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pull</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mongo</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="创建mongodb容器" tabindex="-1">创建MongoDB容器 <a class="header-anchor" href="#创建mongodb容器" aria-label="Permalink to &quot;创建MongoDB容器&quot;">​</a></h2><h3 id="无账号" tabindex="-1">无账号 <a class="header-anchor" href="#无账号" aria-label="Permalink to &quot;无账号&quot;">​</a></h3><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 27017</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:27017</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> my-mongo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mongo</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>这样就创建好一个免验证的MongoDB服务了，可以通过<code>mongodb://localhost:27017</code>来连接数据库</p><h3 id="需要账号" tabindex="-1">需要账号 <a class="header-anchor" href="#需要账号" aria-label="Permalink to &quot;需要账号&quot;">​</a></h3><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 27017</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:27017</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MONGO_INITDB_ROOT_USERNAME=root</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MONGO_INITDB_ROOT_PASSWORD=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123456</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> my-mongo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mongo</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --auth</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">提示</p><p>环境变量<code>MONGO_INITDB_ROOT_USERNAME</code>和<code>MONGO_INITDB_ROOT_PASSWORD</code>用来设置初始的默认账号和密码</p><p><code>--auth</code>的意思是需要密码才能访问容器服务，因为 MongoDB 默认是不开启权限验证的，这里就相当于修改了 MongoDB 的配置<code>auth=ture</code>启用权限访问</p></div><p>或者先不设置账号密码，过后通过命令行进行设置</p><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -dit</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 27017</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:27017</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> my-mongo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mongo</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --auth</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>进入容器，连接<code>admin</code>数据库</p><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> exec</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> my-mongo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mongosh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> admin</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>创建<code>root</code>用户并授权登录</p><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">db.createUser(</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">user:&quot;root&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pwd:&quot;123456&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> roles:[{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> role:&quot;root&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> db:&quot;admin&quot;}]</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> }</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">db.auth(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&#39;root&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;123456&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>然后就可以使用<code>mongodb://root:123456@localhost:27017</code>来连接数据库了</p><h2 id="mongodb添加用户命令说明" tabindex="-1">MongoDB添加用户命令说明 <a class="header-anchor" href="#mongodb添加用户命令说明" aria-label="Permalink to &quot;MongoDB添加用户命令说明&quot;">​</a></h2><ul><li><code>user</code>：用户的名字</li><li><code>pwd</code>：用户的密码</li><li><code>cusomData</code>：任意内容，一般在这里描述用户的额外信息</li><li><code>roles</code>：指定用户的角色，可以是内置角色或自定义的角色 <ul><li><code>role</code>：角色名</li><li><code>db</code>：数据库的名字</li></ul></li></ul><h2 id="mongodb内置角色说明" tabindex="-1">MongoDB内置角色说明 <a class="header-anchor" href="#mongodb内置角色说明" aria-label="Permalink to &quot;MongoDB内置角色说明&quot;">​</a></h2><ul><li>数据库用户角色：<code>read</code>、<code>readWrite</code></li><li>数据库管理角色：<code>dbAdmin</code>、<code>dbOwner</code>、<code>userAdmin</code></li><li>集群管理角色：<code>clusterAdmin</code>、<code>clusterManager</code>、<code>clusterMonitor</code>、<code>hostManage</code></li><li>备份恢复角色：<code>backup</code>、<code>restore</code></li><li>所有数据库角色：<code>readAnyDatabase</code>、<code>readWriteAnyDatabase</code>、<code>userAdminAnyDatabase</code>、<code>dbAdminAnyDatabase</code></li><li>超级用户角色：<code>root</code></li><li>内部角色：<code>__system</code></li></ul><h2 id="mongodb中的role详解" tabindex="-1">MongoDB中的<code>role</code>详解 <a class="header-anchor" href="#mongodb中的role详解" aria-label="Permalink to &quot;MongoDB中的`role`详解&quot;">​</a></h2><table><thead><tr><th>角色</th><th>说明</th></tr></thead><tbody><tr><td><code>read</code></td><td>允许用户读取指定数据库</td></tr><tr><td><code>readWrite</code></td><td>允许用户读写指定数据库</td></tr><tr><td><code>dbAdmin</code></td><td>允许用户在指定数据库中执行管理函数，如索引创建、删除，查看统计或访问 system.profile</td></tr><tr><td><code>userAdmin</code></td><td>允许用户向 system.users 集合写入，可以在指定数据库里创建、删除和管理用户</td></tr><tr><td><code>clusterAdmin</code></td><td>只在 admin 数据库中可用，赋予用户所有分片和复制集相关函数的管理权限</td></tr><tr><td><code>readAnyDatabase</code></td><td>只在 admin 数据库中可用，赋予用户所有数据库的读权限</td></tr><tr><td><code>readWriteAnyDatabase</code></td><td>只在 admin 数据库中可用，赋予用户所有数据库的读写权限</td></tr><tr><td><code>userAdminAnyDatabase</code></td><td>只在 admin 数据库中可用，赋予用户所有数据库的 userAdmin 权限</td></tr><tr><td><code>dbAdminAnyDatabase</code></td><td>只在 admin 数据库中可用，赋予用户所有数据库的 dbAdmin 权限</td></tr><tr><td><code>root</code></td><td>只在 admin 数据库中可用，超级账号，超级权限</td></tr></tbody></table>',23),n=[d];function o(l,h,r,p,c,k){return i(),a("div",null,n)}const m=s(t,[["render",o]]);export{F as __pageData,m as default};
